The best solution for pulling multiple levels of granularity over the same dataset in SQL Server is by using grouping sets. 
Microsoft official docs: https://learn.microsoft.com/en-us/sql/t-sql/queries/select-group-by-transact-sql?view=sql-server-ver16
Here is a tutorial: https://www.sqlservertutorial.net/sql-server-basics/sql-server-grouping-sets/
